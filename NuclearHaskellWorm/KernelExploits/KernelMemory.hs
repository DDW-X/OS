-- KernelMemory.hs
-- Auto-generated scaffold.

module KernelExploits.KernelMemory where

import Foreign.Ptr
import Foreign.C.Types
import Foreign.C.String
import System.Posix.Internals

readKernelMemory :: Ptr a -> IO Word64
readKernelMemory ptr = do
    -- استفاده از syscall مستقیم برای دسترسی به حافظه هسته
    result <- c_syscall 324 (ptrToWordPtr ptr)  -- SYS_KERNEL_READ
    return $ fromIntegral result

writeKernelMemory :: Ptr a -> Word64 -> IO ()
writeKernelMemory ptr value = do
    _ <- c_syscall 325 (ptrToWordPtr ptr) (fromIntegral value)  -- SYS_KERNEL_WRITE
    return ()

foreign import ccall unsafe "syscall"
    c_syscall :: CInt -> WordPtr -> IO CLong
    